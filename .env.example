# EASI Environment Configuration Template
# Copy this file to .env and update with your local development values
# IMPORTANT: Never commit .env to version control!

# =============================================================================
# PostgreSQL Configuration (docker-compose.yml)
# =============================================================================
POSTGRES_USER=easi
POSTGRES_PASSWORD=easi
POSTGRES_DB=easi

# =============================================================================
# Database User Credentials (provision-db-users.sh)
# =============================================================================
# These passwords are used by the deploy script to create/update database users.
# In production (Azure), these come from Azure DevOps library variables.
# For local development, defaults are used automatically (no .env needed).
EASI_APP_PASSWORD=localdev
EASI_ADMIN_PASSWORD=localdev

# =============================================================================
# Migration Service Configuration (docker-compose.yml)
# =============================================================================
# Used by the migrate service to run database migrations
# Format: host=<host> port=<port> user=<user> password=<password> dbname=<dbname> sslmode=<mode>
DB_ADMIN_CONN_STRING=host=postgres port=5432 user=easi password=easi dbname=easi sslmode=disable

# =============================================================================
# Backend Service Configuration (docker-compose.yml)
# =============================================================================
# Used by the backend API service for runtime database access
# Uses easi_app user which has RLS policies applied
# Format: host=<host> port=<port> user=<user> password=<password> dbname=<dbname> sslmode=<mode>
DB_CONN_STRING=host=postgres port=5432 user=easi_app password=localdev dbname=easi sslmode=disable

# =============================================================================
# PgAdmin Configuration (docker-compose.yml)
# =============================================================================
PGADMIN_DEFAULT_EMAIL=admin@easi.com
PGADMIN_DEFAULT_PASSWORD=easi

# =============================================================================
# E2E Test Database Configuration (docker-compose.e2e.yml)
# =============================================================================
E2E_POSTGRES_USER=easi_test
E2E_POSTGRES_PASSWORD=easi_test
E2E_POSTGRES_DB=easi_test

# =============================================================================
# Integration Test Configuration
# =============================================================================
# Used by Go integration tests to connect to local PostgreSQL
INTEGRATION_TEST_DB_HOST=localhost
INTEGRATION_TEST_DB_PORT=5432
INTEGRATION_TEST_DB_USER=easi
INTEGRATION_TEST_DB_PASSWORD=easi
INTEGRATION_TEST_DB_NAME=easi
INTEGRATION_TEST_DB_SSLMODE=disable

# =============================================================================
# Authentication Mode Configuration
# =============================================================================
# AUTH_MODE controls how authentication behaves:
#   - production: (default) HTTPS required, full authentication enabled
#   - local_oidc: HTTP allowed for OIDC, full authentication enabled (test OIDC flow locally)
#   - bypass: HTTP allowed, authentication bypassed (use X-Tenant-ID header for tenant context)
AUTH_MODE=bypass

# =============================================================================
# OIDC Authentication Configuration (REQUIRED)
# =============================================================================
# Client secret for OIDC authentication - must match the secret configured in your IdP (Dex)
# This is required for the backend to start - no default value is provided for security
OIDC_CLIENT_SECRET=easi-test-secret

# Platform admin API key for administrative operations
PLATFORM_ADMIN_API_KEY=localdev

# =============================================================================
# Optional Authentication Configuration
# =============================================================================
# Comma-separated list of allowed origins for post-authentication redirects
# ALLOWED_ORIGINS=http://localhost:3000,http://localhost:5173

# Frontend URL for post-authentication redirect (defaults to /easi/)
# FRONTEND_URL=http://localhost:5173/easi/

# OIDC callback URL (defaults to http://localhost:8080/api/v1/auth/callback)
# OIDC_REDIRECT_URL=http://localhost:8080/api/v1/auth/callback
